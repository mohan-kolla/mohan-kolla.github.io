<!DOCTYPE html>
<html>
<head>
  <title>Personal Blog - Mohan Kolla</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Alice&display=swap" rel="stylesheet">
  <style>
    html,body,h1,h2,h3,h4,h5,h6 { font-family: Alice; }

    /* Top Navigation Bar Styles */
    .topnav {
      background-color: #333;
      overflow: hidden;
    }
    .topnav a {
      float: left;
      color: #f2f2f2;
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
      font-size: 17px;
    }
    .topnav a:hover {
      background-color: #ddd;
      color: black;
    }
    .topnav a.active {
      background-color: #04AA6D;
      color: white;
    }
    .topnav button {
      float: right;
      margin: 8px 16px;
    }

    /* Close button for forms */
    .w3-modal .w3-modal-content {
      position: relative;
    }
    .w3-modal .w3-button.w3-display-topright {
      position: absolute;
      right: 0;
      top: 0;
      padding: 8px 16px;
    }
  </style>
</head>
<body class="w3-light-grey">
  <!-- Navigation Bar -->
  <div class="topnav">
    <a href="../index.html">Home</a>
    <a href="../projects/current-projects.html">Current Projects</a>
    <a href="personal-blog.html" class="active">Personal Blog</a>
    <a href="#about">About</a>
    <button class="w3-button w3-green" onclick="document.getElementById('login-form').style.display='block'">Admin Login</button>
  </div>

  <!-- Blog Entries -->
  <div class="w3-content w3-margin-top" style="max-width:1400px;">
    <div class="w3-container w3-center">
      <!-- Add Blog Entry Button (Visible to Admins) -->
      <button id="add-blog-btn" class="w3-button w3-green" onclick="openBlogForm()" style="display: none;">Add Blog Entry</button>
    </div>
    <div id="blog-entries" class="w3-container">
      <!-- Blog entries will be dynamically inserted here -->
    </div>
  </div>

  <!-- Login Form -->
  <div id="login-form" class="w3-modal">
    <div class="w3-modal-content w3-card-4 w3-animate-zoom" style="max-width:600px">
      <div class="w3-center">
        <h3>Admin Login</h3>
      </div>
      <div class="w3-container">
        <label for="username"><b>Username</b></label>
        <input class="w3-input w3-border" type="text" placeholder="Enter Username" id="username" required>
        <label for="password"><b>Password</b></label>
        <input class="w3-input w3-border" type="password" placeholder="Enter Password" id="password" required>
        <button class="w3-button w3-block w3-green w3-section w3-padding" onclick="login()">Login</button>
      </div>
    </div>
  </div>

  <!-- Add/Edit Blog Form -->
  <div id="blog-form" class="w3-modal">
    <div class="w3-modal-content w3-card-4 w3-animate-zoom" style="max-width:600px">
      <span onclick="document.getElementById('blog-form').style.display='none'" class="w3-button w3-display-topright">&times;</span>
      <div class="w3-center">
        <h3 id="form-title">Add Blog Entry</h3>
      </div>
      <div class="w3-container">
        <label for="blog-title"><b>Title</b></label>
        <input class="w3-input w3-border" type="text" placeholder="Enter Title" id="blog-title" required>
        <label for="blog-content"><b>Content</b></label>
        <textarea class="w3-input w3-border" placeholder="Enter Content" id="blog-content" required></textarea>
        <button class="w3-button w3-block w3-green w3-section w3-padding" onclick="saveEntry()">Save</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="w3-container w3-green w3-center w3-margin-top">
    <p>Find me on social media.</p>
    <a href="https://www.instagram.com/mohankrishna.kolla/" target="_blank"><i class="fa fa-instagram w3-hover-opacity"></i></a> 
    <a href="https://www.linkedin.com/in/mohan-kolla-1b428524b/" target="_blank"><i class="fa fa-linkedin w3-hover-opacity"></i></a> 
  </footer>

  <script>
    let isAdmin = false;
    let editingEntryId = null;

    // Check if user is logged in as admin
    function checkAdmin() {
      const addBlogBtn = document.getElementById('add-blog-btn');
      addBlogBtn.style.display = isAdmin ? 'block' : 'none';
    }

    // Login function
    function login() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      // Updated credentials
      if (username === 'EmpMo666' && password === 'LilithKolla21') {
        isAdmin = true;
        document.getElementById('login-form').style.display = 'none';
        checkAdmin();
        renderBlogEntries();
      } else {
        alert('Invalid credentials');
      }
    }

    // Sample Blog Entries in localStorage
    if (!localStorage.getItem('blogEntries')) {
      localStorage.setItem('blogEntries', JSON.stringify([]));
    }

    function getBlogEntries() {
      return JSON.parse(localStorage.getItem('blogEntries')) || [];
    }

    function saveBlogEntries(entries) {
      localStorage.setItem('blogEntries', JSON.stringify(entries));
    }

    function renderBlogEntries() {
      const entries = getBlogEntries();
      const blogContainer = document.getElementById('blog-entries');
      blogContainer.innerHTML = '';

      entries.forEach(entry => {
        const entryHTML = `
          <div class="w3-card-4 w3-margin w3-white">
            <div class="w3-container">
              <h3>${entry.title}</h3>
              <h5>${entry.date}</h5>
            </div>
            <div class="w3-container">
              <p>${entry.content}</p>
              ${isAdmin ? `
                <button class="w3-button w3-green" onclick="editEntry('${entry.id}')">Edit</button>
                <button class="w3-button w3-red" onclick="deleteEntry('${entry.id}')">Delete</button>
              ` : ''}
            </div>
          </div>
        `;
        blogContainer.innerHTML += entryHTML;
      });
    }

    function openBlogForm(entryId = null) {
      editingEntryId = entryId;
      const formTitle = entryId ? 'Edit Blog Entry' : 'Add Blog Entry';
      document.getElementById('form-title').innerText = formTitle;
      document.getElementById('blog-form').style.display = 'block';

      if (entryId) {
        const entry = getBlogEntries().find(e => e.id === entryId);
        document.getElementById('blog-title').value = entry.title;
        document.getElementById('blog-content').value = entry.content;
      } else {
        document.getElementById('blog-title').value = '';
        document.getElementById('blog-content').value = '';
      }
    }

    function saveEntry() {
      const title = document.getElementById('blog-title').value;
      const content = document.getElementById('blog-content').value;
      const entries = getBlogEntries();

      if (editingEntryId) {
        // Update existing entry
        const index = entries.findIndex(e => e.id === editingEntryId);
        entries[index] = { ...entries[index], title, content };
      } else {
        // Add new entry
        const newEntry = {
          id: Date.now().toString(),
          title,
          content,
          date: new Date().toLocaleDateString(),
        };
        entries.push(newEntry);
      }

      saveBlogEntries(entries);
      document.getElementById('blog-form').style.display = 'none';
      renderBlogEntries();
    }

    function deleteEntry(entryId) {
      const entries = getBlogEntries().filter(e => e.id !== entryId);
      saveBlogEntries(entries);
      renderBlogEntries();
    }

    // Initial render
    renderBlogEntries();
    checkAdmin();
  </script>
</body>
</html>
